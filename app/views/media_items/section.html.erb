<section>
  <p>
    <%= link_to "Add new title", search_media_items_path(media_type: (@media_type == "anime" ? "anime" : @media_type), source: @media_type), class: "btn" %>
  </p>
  <h2><%= @media_type == "movie" ? "movies" : @media_type == "tv" ? "tv shows" : "anime" %></h2>

  <h3>planned</h3>
  <div class="grid">
    <% @planned.each do |item| %>
      <% m = item.media_item %>
      <div class="card">
        <% if m.poster_path.present? %>
          <img src="https://image.tmdb.org/t/p/w200<%= m.poster_path %>" alt="<%= m.title %>">
        <% end %>
        <div class="title"><%= m.title %></div>
        <% if m.release_date %><div class="card-date"><%= m.release_date.year %></div><% end %>
        <div class="card-actions">
          <%= button_to "mark watched", watchlist_item_path(item), method: :patch, class: "btn",
                params: { status: "watched", watched_on: Date.today } %>
          <%= button_to "remove", watchlist_item_path(item), method: :delete, class: "btn" %>
        </div>
      </div>
    <% end %>
  </div>

  <h3>watched</h3>
  <div class="grid">
    <% @watched.each do |item| %>
      <% m = item.media_item %>
      <div class="card">
        <% if m.poster_path.present? %>
          <img src="https://image.tmdb.org/t/p/w200<%= m.poster_path %>" alt="<%= m.title %>">
        <% end %>
        <div class="title"><%= m.title %></div>
        <% if m.release_date %><div class="card-date"><%= m.release_date.year %></div><% end %>
        <div class="card-actions">
          <%= button_to "move to planned", watchlist_item_path(item), method: :patch, class: "btn",
                params: { status: "planned" } %>
          <%= button_to "remove", watchlist_item_path(item), method: :delete, class: "btn" %>
        </div>
      </div>
    <% end %>
  </div>
</section>
